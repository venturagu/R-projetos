firstViolent <- distOrder[1,1]
secondViolent <- distOrder[1,2]
thirdViolent <- distOrder[1,3]
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[1,2]
thirdViolent <- distOrder[1,3]
print(firstViolent)
print(secondViolent)
print(thirdViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(firstViolent)
print(secondViolent)
print(thirdViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
class(firstViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- str(distOrder[1,1])
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
class(firstViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
srt(firstViolent)
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
str(firstViolent)
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder[1,1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(firstViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(firstViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(thirdViolent)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
test <- plot_temporal_grap(firstViolent, geralFilter)
test
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
secondViolent
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
secondViolent
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(firstViolent)
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(secondViolent)
print(thirdViolent)
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
firstViolent_graph <- plot_temporal_grap("D4", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
thirdViolent_graph <- plot_temporal_grap("B2", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
thirdViolent_graph <- plot_temporal_grap("B2", geralFilter)
thirdViolent_graph <- plot_temporal_grap("B2", geralFilter)
thirdViolent_graph <- plot_temporal_grap("B2", geralFilter)
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(thirdViolent)
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
#firstViolent_graph <- plot_temporal_grap("D4", geralFilter)
#secondViolent_graph <- plot_temporal_grap("A1", geralFilter)
thirdViolent_graph <- plot_temporal_grap("B2", geralFilter)
thirdViolent
thirdViolent_graph
thirdViolent_graph
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent_graph
thirdViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
thirdViolent_graph
thirdViolent
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent_graph
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
fisrtViolent
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
secondViolent_graph
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent_graph
secondViolent_graph
fisrtViolent
ggplot(geralFilter, aes(x = Long, y = Lat, group=DISTRICT, colour = DISTRICT))+
geom_point(size = 1, alpha = 1) +
xlim(-71.15, -70.90) +
ylim(42.2,42.4) +
facet_grid(.~OFFENSE_CODE_GROUP)
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
fisrtViolent
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
secondViolent_graph
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
thirdViolent_graph
facet_grid(rows = 1, cols = 3)
par(mfrow=c(1,3))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
par(mfrow=c(1,3))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
par(mfrow=c(2,2))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(thirdViolent)
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
par(mfrow=c(2,2))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
firstViolent_graph
secondViolent_graph
thirdViolent_graph
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
firstViolent_graph + facet_wrap()
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
grid.arrange(firstViolent_graph, secondViolent_graph, thirdViolent_graph)
old.par <- par(mfrow=c(1, 3))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
par(old.par)
#Preparação dos dados para todos os crimes
geral_distric<-as.data.frame(table(unlist(geralFilter$DISTRICT)))
distOrder <- geral_distric[order(- geral_distric$Freq), ]
#3 Distritos mais violentos
firstViolent <- distOrder$Var1[1]
secondViolent <- distOrder[2,1]
thirdViolent <- distOrder[3,1]
print(thirdViolent)
#Função que gera o grafico temporal dado um distrito
plot_temporal_grap <- function(dist, geralFilter) {
#Gerando os filtros especificos
lacerny_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Larceny")
drug_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Drug Violation")
homicide_filter <- filter(geralFilter, DISTRICT == dist & OFFENSE_CODE_GROUP == "Homicide")
#Gerando tabelas
lacerny_year <- as.data.frame(table(unlist(lacerny_filter$YEAR)))
drug_year <- as.data.frame(table(unlist(drug_filter$YEAR)))
homicide_year <- as.data.frame(table(unlist(homicide_filter$YEAR)))
#Gerando a tabela principal que sera usada para gerar os graficos
main_table <- data.frame(YEAR = lacerny_year$Var1, LACERNY = lacerny_year$Freq, DRUG = drug_year$Freq,
HOMICIDE = homicide_year$Freq)
#Gerando o grafico temporal que sera retornado
df_main <- melt(main_table, id.vars='YEAR')
result <- ggplot(df_main, aes(x=YEAR, y=value, fill=variable)) +
geom_bar(stat='identity', position='dodge') +
labs(subtitle = "Ocorrencias ao longos do anos na regiao", title = dist) +
xlab("Anos") +
ylab("Ocorrências")
return(result)
}
old.par <- par(mfrow=c(1, 3))
firstViolent_graph <- plot_temporal_grap(firstViolent, geralFilter)
secondViolent_graph <- plot_temporal_grap(secondViolent, geralFilter)
thirdViolent_graph <- plot_temporal_grap(thirdViolent, geralFilter)
par(old.par)
